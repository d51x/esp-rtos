function ajax_request(e,t){var n;if("undefined"!=typeof XMLHttpRequest)n=new XMLHttpRequest;else for(var i=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],a=0,r=i.length;a<r;a++)try{n=new ActiveXObject(i[a]);break}catch(e){}n.onreadystatechange=function(){if(n.readyState<4)return;if(200!==n.status)return;4===n.readyState&&t(n)},n.open("GET",e,!0),n.send("")}function on(e,t,n){e.addEventListener?e.addEventListener(t,function(){n(e,t)},!1):e.attachEvent&&e.attachEvent(t,function(){n(e,t)})}for(var inputs=document.getElementsByTagName("input"),i=0;i<inputs.length;i++)"range"==inputs[i].type.toLowerCase()?["change","input"].forEach(function(e){on(inputs[i],e,function(e,t){"input"==t&&(document.getElementById(e.name).innerHTML=e.value)})}):"checkbox"==inputs[i].type.toLowerCase()&&"relay"==inputs[i].getAttribute("rel")&&["change","input"].forEach(function(e){on(inputs[i],e,function(e,t){if("change"==t){var n=1-parseInt(e.getAttribute("value"));ajax_request("/gpio?pin="+e.name.substr(5)+"&st="+n,function(){e.setAttribute("value",n),e.checked=n,document.getElementById(e.name).innerHTML=n?"ON":"OFF"})}"input"==t&&(document.getElementById(e.name).innerHTML=e.checked?"ON":"OFF")})});var a=document.getElementsByTagName("a");for(i=0;i<a.length;i++)"relay"==a[i].getAttribute("rel")&&on(a[i],"click",function(e,t){var n=1-parseInt(e.getAttribute("data-val"));ajax_request("/gpio?st="+n+"&pin="+e.getAttribute("data-id"),function(){e.setAttribute("data-val",n),e.innerHTML="<button class='relay "+(n?"on":"off")+"' >"+e.getAttribute("data-title")+"</button>"})});function effects(){var e=document.getElementById("effects"),t=e.options[e.selectedIndex].value;e.options[e.selectedIndex].text;ajax_request("/colors?type=effect&id="+t,function(){e.options[t].selected="true"})}function reboot(){ajax_request("/reboot?st=1",setTimeout(function(){window.location.replace("/")},3e3)),document.getElementById("rbt").style.display="block"}function i2cscan(){ajax_request("/i2cscan?st=1",function(e){document.getElementById("i2cres").innerHTML="<h4>Результаты сканирования:</h4><p>"+e.responseText+"</p>"})}function btnclick(e,t,n,i){var a=document.getElementById(e),r=a.getAttribute("data-uri"),o=a.getAttribute("data-val"),s=r;o>-1&&(s=r+o),ajax_request(s,function(e){if(1==i){var r=0,s=e.responseText;r="OFF"==s?0:0==s?0:"ON"==s?1:1==s?1:"ERROR"==s?o:"OK"==s?!o:0;var c=a.getAttribute("data-class"),u=r>0?" on":" off";a.setAttribute("class",c+u),a.setAttribute("data-val",1-r)}var l=document.getElementById(t);if(1==n)l.innerHTML=a.getAttribute("data-text")+e.responseText;else if(2==n){var d=a.getAttribute("data-text");l.innerHTML=d.replace("{0}",e.responseText)}else l.innerHTML=a.getAttribute("data-text")})}function change_color(e,t){if(t.indexOf("ledc10")>=0){var n=document.getElementById("colors").getAttribute("style"),i=(n=(n=n.substr(15,n.length)).substr(0,n.length-1)).split(",");"ledc100"==t?i[0]=e:"ledc101"==t?i[1]=e:"ledc102"==t&&(i[2]=e),n="background:rgb("+(n=i.join())+")",document.getElementById("colors").setAttribute("style",n)}}function slider(e,t,n){change_color(e,t),ajax_request(n+e,function(e){var n=e.responseText;document.getElementById(t).innerHTML=n})}function otaGet(e){var t=document.getElementById("selectedFile").files[0],n="<h4>File: "+t.name+"<br>Size: "+t.size+" bytes</h4>";t.size>e&&(n+="<h4 style='color: red;'>Files size is bigger than partition size!!!</h4>"),document.getElementById("file_info").innerHTML=n}function updFw(){var e=document.getElementById("selectedFile");if(e.files&&1==e.files.length){var t=e.files[0];document.getElementById("ota_process").innerHTML="Uploading "+t.name+" , Please Wait..."}else window.alert("Select A File First")}