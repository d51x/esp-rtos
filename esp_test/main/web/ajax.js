function ajax_request(t,e){function n(){a.readyState<4||200===a.status&&4===a.readyState&&e(a)}var a;if("undefined"!=typeof XMLHttpRequest)a=new XMLHttpRequest;else for(var i=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],u=0,r=i.length;r>u;u++)try{a=new ActiveXObject(i[u]);break}catch(o){}a.onreadystatechange=n,a.open("GET",t,!0),a.send("")}function on(t,e,n){t.addEventListener?t.addEventListener(e,function(){n(t,e)},!1):t.attachEvent&&t.attachEvent(e,function(){n(t,e)})}for(var inputs=document.getElementsByTagName("input"),i=0;i<inputs.length;i++)"range"==inputs[i].type.toLowerCase()?["change","input"].forEach(function(t){on(inputs[i],t,function(t,e){"change"==e&&ajax_request("/ledc?ch="+t.name.substr(4)+"&duty="+t.value,function(){document.getElementById(t.name).innerHTML=t.value}),"input"==e&&(document.getElementById(t.name).innerHTML=t.value)})}):"checkbox"==inputs[i].type.toLowerCase()&&"relay"==inputs[i].getAttribute("rel")&&["change","input"].forEach(function(t){on(inputs[i],t,function(t,e){if("change"==e){var n=1-parseInt(t.getAttribute("value"));ajax_request("/gpio?pin="+t.name.substr(5)+"&st="+n,function(){t.setAttribute("value",n),t.checked=n,document.getElementById(t.name).innerHTML=n?"ON":"OFF"})}"input"==e&&(document.getElementById(t.name).innerHTML=t.checked?"ON":"OFF")})});for(var a=document.getElementsByTagName("a"),i=0;i<a.length;i++)"relay"==a[i].getAttribute("rel")&&on(a[i],"click",function(t,e){var n=1-parseInt(t.getAttribute("data-val"));ajax_request("/gpio?st="+n+"&pin="+t.getAttribute("data-id"),function(){t.setAttribute("data-val",n),t.innerHTML="<button class='relay "+(n?"on":"off")+"' >"+t.getAttribute("data-title")+"</button>"})});